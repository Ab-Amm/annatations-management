<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <title>My Tasks</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .task-table {
            margin: 2rem auto;
            max-width: 1200px;
        }
        .progress-container {
            min-width: 150px;
        }
        .action-btn {
            white-space: nowrap;
        }
    </style>
</head>
<body class="bg-light">
<div class="container">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="my-4">Welcome, <span sec:authentication="name"></span></h1>
        <form th:action="@{/logout}" method="post">
            <button type="submit" class="btn btn-secondary">Logout</button>
        </form>
    </div>

    <div class="card task-table">
        <div class="card-header bg-primary text-white">
            <h4 class="mb-0">My Annotation Tasks</h4>
        </div>

        <div class="card-body">
            <table class="table table-hover">
                <thead class="table-light">
                <tr>
                    <th>Task ID</th>
                    <th>Dataset</th>
                    <th>Deadline</th>
                    <th>Progress</th>
                    <th>Items Remaining</th>
                    <th>Actions</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="task : ${annotator.tasks}" th:if="${task.coupleTexts}">
                    <td th:text="${task.id}">123</td>
                    <td th:text="${task.dataset.name}">Dataset Name</td>
                    <td>
                            <span th:text="${#temporals.format(task.deadline, 'dd MMM yyyy')}">
                                31 Dec 2024
                            </span>
                    </td>
                    <td class="progress-container">
                        <div class="progress">
                            <div class="progress-bar bg-success"
                                 role="progressbar"
                                 th:style="'width: ' + ${task.couplesDone} + '%'"
                                 th:text="${task.couplesDone * 100 / task.coupleTexts.size()}  + '%'">
                                75%
                            </div>
                        </div>
                    </td>
                    <td>
                            <span th:text="${task.coupleTexts.size()} + ' items'">
                                100 items
                            </span>
                    </td>
                    <td>
                        <a th:if="${task.couplesDone * 100 / task.coupleTexts.size()} != 100"
                           th:href="@{/annotator/tasks/annotateTask/{id}(id=${task.id})}"
                           class="btn btn-primary action-btn">
                            Start Annotating
                        </a>
                        <span th:unless="${task.couplesDone * 100 / task.coupleTexts.size()} != 100"
                              class="text-success fw-bold">
                                Done
                        </span>
                    </td>

                </tr>
                <tr th:if="${#lists.isEmpty(annotator.tasks)}">
                    <td colspan="6" class="text-center text-muted py-4">
                        No tasks assigned yet
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
</body>
</html>